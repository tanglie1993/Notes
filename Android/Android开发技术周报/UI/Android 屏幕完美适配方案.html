<html>
<head>
  <title>Android 屏幕完美适配方案</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.15063 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2883"/>
<h1>Android 屏幕完美适配方案</h1>

<div><span><div style="-evernote-webclip:true"><br/><div><div><div><div><h1> Android 屏幕完美适配方案 </h1><div><div></div></div></div>
                <div>
                                                            <em>2017-09-04</em>

                                        <em>jiashuai94</em>
                                        <a href="https://mp.weixin.qq.com/s/e26d6s3hpWJOmhA4AUqRbQ?utm_source=androidweekly.cn&amp;utm_medium=website##" target="_blank">mobilehub</a>
                    

                    
                </div>
                
                
                
                
                                                
                                                                
                
                
                    

                    

                    
                    
                    <div><p><img src="Android 屏幕完美适配方案_files/0.gif" type="image/gif" data-filename="0.gif" height="90" title="叮当猫求关注" width="755"/></p></div><p>作者 | jiashuai94 </p><p>微信公众号 | mobilehub</p><p></p><div><img src="Android 屏幕完美适配方案_files/640.webp" type="image/webp" data-filename="640.webp"/></div><p></p><div><div><div><strong>为什么要适配</strong></div></div></div><p>由于Android系统的开放性，任何用户、开发者、硬件厂商、运营商都可以对Android系统和硬件进行定制，修改成他们想要的样子。</p><p>但是这种“碎片化”到达什么程度呢？</p><p></p><div><img src="Android 屏幕完美适配方案_files/Image.png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p>以上每一个矩形都代表一种机型，且它们屏幕尺寸、屏幕分辨率大相径庭。随着Android设备的增多，设备碎片化、品牌碎片化、系统碎片化、屏幕碎片化的程度也在不断加深。</p><p>为了让我们的Android应用在各式各样的手机上运行的时候，能够保持界面效果一直，所以，我们需要对各种手机屏幕进行适配！</p><div><div><div><strong>概念</strong></div></div></div><p><strong>1、像素（px）</strong></p><p>通常所说的像素，就是CCD/CMOS上光电感应元件的数量，一个感光元件经过感光，光电信号转换，A/D转换等步骤以后，在输出的照片上就形成一个点，我们如果把影像放大数倍，会发现这些连续色调其实是由许多色彩相近的小方点所组成，这些小方点就是构成影像的最小单位“像素”（Pixel）。</p><p>简而言之，<strong>像素就是手机屏幕的最小构成单元</strong>。</p><p><strong>2、分辨率</strong></p><p>手机在横向、纵向上的像素点数总和，一般描述成 宽*高 ，</p><p>即<strong>横向像素点个数*纵向像素点个数</strong>。</p><p><strong>3、屏幕尺寸（in）</strong></p><p>手机对角线的物理尺寸，单位 英寸（inch），一英寸大约2.54cm，常见的尺寸有4.7寸、5寸、5.5寸、6寸</p><p><strong>4、屏幕像素密度（dpi）</strong></p><p>每英寸长度上像素点个数。</p><p>例如每英寸内有160个像素点，则其像素密度为160dpi。</p><p>公式： <strong>像素密度=像素/尺寸 （dpi=px/in）</strong></p><p><strong>5、标准屏幕像素密度（mdpi）</strong></p><p>每英寸长度上还有160个像素点，即称为标准屏幕像素密度（mdpi）。</p><p><strong>6、像素密度等级</strong></p><p>手机真实像素密度与标准屏幕像素密度（160dpi）的比值。官方给出的0.75、1、1.5、2、3、4，即对应120dpi、160dpi、240dpi、320dpi、480dpi、640dpi。</p><p><strong>7、密度无关像素（dp）</strong></p><p>density-independent pixel，叫dp或dip，与终端上的实际物理像素点无关。可以保证在不同屏幕像素密度的设备上显示相同的效果，是安卓特有的长度单位。</p><p><strong>8、独立比例像素（sp）</strong></p><p>scale-independent pixel，叫sp或sip，字体大小专用单位，可根据字体大小首选项进行缩放；</p><p>推荐使用12sp、14sp、18sp、22sp作为字体大小，不推荐使用奇数和小数，容易造成精度丢失，12sp以下字体太小。</p><p><strong>9、尺寸、像素、像素密度关系</strong></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [1].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p><strong>10、px与dp关系</strong></p><p><strong>像素=dp*像素密度等级，即px=dp*(dpi/160)</strong></p><div><div><div><strong>对哪些设备适配</strong></div></div></div><p>注意进行Android设备的屏幕适配操作，不是单单对屏幕尺寸多样的各种设备进行的适配，在诸多的物理尺寸的背后是屏幕的分辨率，现在市面上占比最多的六种分辨率：480*800、320*480、480*854、540*960、720*1280、1080*1920。在日常适配中只要做好对这几个设备的适配，就能很好的适配其他机型。但是在这几种分辨率的背后存在的更为根本的数据是设备的屏幕像素密度。在Google文档中对于屏幕的像素密度进行了几种规定！</p><p>另外也需注意对安卓平板、安卓电视等大尺寸、超大尺寸设备的适配。</p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [2].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [3].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><div><div><div><strong>如何适配</strong></div></div></div><p><strong>1、适配误区</strong></p><p>在进行适配的时候，人们总是关注于：代码、Layout、Dimens、图片、权重，这几种适配方式并不是屏幕适配的全部方案，除此之外还存在多种小细节来实现屏幕适配。</p><p><strong>如何理解使用dp为单位进行适配？：</strong></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [4].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p>但是，使用密度无关像素（dp）也不能做到适配所有屏幕！</p><p><strong>2、造成误差原因</strong></p><p>在长期的Android发展过程中，由于Android设备的增多，Google制定的屏幕密度标准（mdpi、hdpi、ldpi等），在众多厂家的生产过程中，已经被打破，人们没有生产数完全符合屏幕密度标准的Android设备，对于真实手机的屏幕密度值，是在Google标准的周围浮动变化的，但是不乏存在一些厂商生产的设备偏离Google的屏幕密度标准比较大，这个时候再使用dp作为单位就不能完完全全的完成适配操作！（dp只有在大家标准统一的情况下才有更好的发展）</p><p>在所有计算公式中存在误差：在计算真实像素密度时运用了开方运算和除法运算，导致所得结果存在误差。</p><p>理论计算造成的误差：</p><p>在计算对角线上像素点个数时，我们使用勾股定理计算得出，但实则存在误差：</p><ul><li><p>若将像素长度当做1，分辨率指的是横纵向上的1的个数，计算记过表示的是对角线上有多少个1，但理论上对角线上 根号2 的个数才是像素点的个数！</p></li><li><p>屏幕对角线并不会和像素对角线重合，使计算结果存在误差。 </p></li></ul><p></p><div><img src="Android 屏幕完美适配方案_files/Image [5].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p><strong>3、ldpi、mdpi、hdpi、xhdpi、xxhdpi的使用</strong></p><p>官方截图： </p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [6].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [7].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p><strong>4、使用wrap_content、match_parent、权重</strong></p><p>要确保布局的灵活性并适应各种尺寸的屏幕，应使用 “wrap_content” 、“match_parent”和权重控制某些视图组件的宽度和高度。</p><p>使用 “wrap_content”，系统就会将视图的宽度或高度设置成所需的最小尺寸以适应视图中的内容，而 “match_parent”（在低于 API 级别 8 的级别中称为 “fill_parent”）则会展开组件以匹配其父视图的尺寸。</p><p>如果使用 “wrap_content” 和 “match_parent” 尺寸值而不是硬编码的尺寸，视图就会相应地仅使用自身所需的空间或展开以填满可用空间。此方法可让布局正确适应各种屏幕尺寸和屏幕方向。</p><p><strong>5、使用相对布局，不要使用绝对布局</strong></p><p>我们大部分时候使用的都是线性布局、相对布局和帧布局，绝对布局由于适配性极差，所以极少使用。</p><p>关于布局的使用应该具体情况具体分析，在进行电视机顶盒的开发中就是使用的是绝对布局。</p><p><strong>6、使用限定符进行适配操作</strong></p><p>使用尺寸限定符——large</p><p>使用最小宽度限定符——swdp</p><p>使用屏幕方向限定符</p><p><strong>7、多套layout适配</strong></p><blockquote><p>res/values/layouts.xml:</p><p>res/values-sw600dp-land/layouts.xml:</p><p>res/values-sw600dp-port/layouts.xml:</p><p>res/values-large-land/layouts.xml:</p><p>res/values-large-port/layouts.xml:</p></blockquote><p><strong>8、使用自动拉伸位图</strong></p><p>支持各种屏幕尺寸通常意味着您的图片资源还必须能适应各种尺寸。例如，无论要应用到什么形状的按钮上，按钮背景都必须能适应。</p><p>如果在可以更改尺寸的组件上使用了简单的图片，您很快就会发现显示效果多少有些不太理想，因为系统会在运行时平均地拉伸或收缩您的图片。解决方法为使用自动拉伸位图，这是一种格式特殊的 PNG 文件，其中会指明可以拉伸以及不可以拉伸的区域。</p><p>.9的制作，实际上就是在原图片上添加1px的边界，然后按照我们的需求，把对应的位置设置成黑色线，系统就会根据我们的实际需求进行拉伸。</p><p><strong>9、普通图片处理</strong></p><p>稍后会详细介绍。</p><p>10、dimens使用</p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [8].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p>如上图，我将市面上各分辨率下的屏幕尺寸，取了平均数，算出对应的真实的屏幕像素密度，与理论要求的屏幕像素密度作了对比，比值在倒数第二列。发现：（干货要来了！）真实像素密度与理论像素密度的比值大致分为两类，取其平均数，一类在1.15左右，另一类则在0.89左右。巧了，它们两类正好各自对应w320dp和w360dp的宽度限定符！所以，dimens只需写两套即可（values-w320dp、values-w360dp），其name与真实数值的比值就是刚刚我们算出的两个平均数！ 以后我们就不需要对应各种分辨率写多套dimens了，两套dimens即可。</p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [9].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><div><div><div><strong>图片处理</strong></div></div></div><p><strong>1、logo</strong></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [10].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p>logo需要36*36、48*48、72*72、96*96、144*144、192*192px，图片使用正方形形状，在某些机型上面，会自动显示为圆角正方形；</p><p>Android8.0以后，系统增加了logo点击效果和动画，可按以上尺寸制作圆形logo，但图片必须为正方形，圆形以外区域透明。</p><p><strong>2、普通图片</strong></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [11].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [12].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p><p>UI切图只需按照720*1280，4.7寸屏幕切图即可；</p><p>应为iphone6等分辨率、尺寸、像素密度都与要求接近，可使用IOS的2x图代替。</p><p><img src="Android 屏幕完美适配方案_files/Image [13].png" type="image/png" data-filename="" height="1" width="1"/></p><p><strong>3、纯色图、.9图</strong></p><p>纯色按钮或渐变按钮可使用代码设置颜色或.9图实现，不必用图片作为背景。</p><p><strong>4、动画、自定义view、shape</strong></p><p>可以使用代码进行控制和展示多种视图，如patch动画替代帧动画。</p><p><strong>5、ImageView的ScaleType</strong></p><p>关于ScaleType请参考这里： http://blog.csdn.net/jiashuai94/article/details/77673625</p><div><div><div><strong>其他</strong></div></div></div><p><strong>1、代码适配</strong></p><p>在代码中使用Google提供的API对设备的屏幕宽度进行测量，然后按照需求进行设置。</p><p>几个主要使用的API：</p><p>对于当前控件的宽高设置，需要做的操作是首先要获取到该控件的父控件，使用父控件对当前控件的宽高进行设置操作！</p><p>API</p><blockquote><p>DisplayMetrics metrics = new DisplayMetrics ();</p><p>getWindowManager().getDefaultDisplay().getMetrics(metrics);</p><p>手机对应的宽高：</p><p>Constants.screenHeight= metrics.heightDixels;</p><p>Constants.screenWidth= metrics.widthDixels;</p><p>RelativeLayout.LayoutParams=new RelativeLayout.LayoutParams();</p><p>(int)( Constants.screenHeight*0.5+0.5f);</p><p>(int)( Constants.screenWidth *0.5+0.5f);</p></blockquote><p>在上面的两个计算操作中最后加上0.5f的作用是：进行float强转到int类型的时候会出现都是精度的问题。当使用Java代码进行宽高设置的时候，假如出现320.2dp这样的数据此时直接进行int得到的值是320；但是假如出现320.7这样的数据的时候，由于int的计算规则，会直接强转为320，但是从实际出发，这个时候的值取321更为合适。</p><p>所以在计算的最后直接加0.5，这样一来，320.2+0.5=320.7，进行数据的强转操作得到的数据是320，320.7+0.5=321.2，进行数据强转操作得到的数据是321，这样一来得到的数据就和实际预想的更为接近！！</p><p><strong>2、接口配合</strong></p><p>本地加载图片前判断手机分辨率或像素密度，向服务器请求对应级别图片。</p><p></p><div><img src="Android 屏幕完美适配方案_files/Image [14].png" type="image/png" data-filename="" height="1" width="1"/></div><p></p></div></div></div><br/></div></span>
</div></body></html> 