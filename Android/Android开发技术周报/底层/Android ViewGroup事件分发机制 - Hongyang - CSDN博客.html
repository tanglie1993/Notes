<html>
<head>
  <title>Android ViewGroup事件分发机制 - Hongyang - CSDN博客</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.15063 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4012"/>
<h1>Android ViewGroup事件分发机制 - Hongyang - CSDN博客</h1>

<div>
<span><div><br/></div><div style="display: inline-block;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><div style="box-sizing: border-box; background-color: rgb(255, 255, 255);"><div style="box-sizing: border-box;"><div style="box-sizing: border-box;"><div style="box-sizing: border-box; background-color: rgb(255, 255, 255);"><div style="box-sizing: border-box;"><h3 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0.5rem 0px 0.3rem; word-break: break-all;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.2rem; font-weight: 500;"><font style="font-size: 12pt;">Android ViewGroup事件分发机制</font></span></h3><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0px 0px 0.1rem;"><font style="font-size: 12pt;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(153, 153, 153); line-height: 1.42857; font-style: normal; box-sizing: border-box;">发表于</span><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(153, 153, 153); line-height: 1.42857; font-style: normal; box-sizing: border-box;">2014/9/9 9:38:03  </span><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(153, 153, 153); line-height: 1.42857; font-style: normal; box-sizing: border-box;">76561</span><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; color: rgb(153, 153, 153); line-height: 1.42857;">人阅读</span></font></div><div style="box-sizing: border-box; margin: 0px 0px 0.3rem; padding: 0px 0px 0.4rem; border-bottom-width: 0.05rem; border-bottom-style: solid; border-bottom-color: rgb(221, 221, 221);"><font style="font-size: 12pt;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(153, 153, 153); line-height: 1.42857;">分类：</span> <span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(153, 153, 153); line-height: 1.42857;">【android 进阶之路】</span> <span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(153, 153, 153); line-height: 1.42857;">【Android 源码解析】</span> </font></div><div style="box-sizing: border-box; word-wrap: break-word; overflow: hidden;"><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;">转载请标明出处：</span><a href="http://blog.csdn.net/lmj623565791/article/details/39102591" style="box-sizing: border-box; background-color: transparent; margin: 0px; padding: 0px; outline: none; font-family: Arial, 'Microsoft YaHei'; line-height: 0.875rem; color: rgb(66, 139, 202); text-decoration: none;" target="_blank">http://blog.csdn.net/lmj623565791/article/details/39102591</a><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;">，本文出自</span><a href="http://blog.csdn.net/lmj623565791/article/details/39102591" style="box-sizing: border-box; background-color: transparent; margin: 0px; padding: 0px; outline: none; font-family: Arial, 'Microsoft YaHei'; line-height: 0.875rem; color: rgb(66, 139, 202); text-decoration: none;" target="_blank">【张鸿洋的博客】</a></font></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;">上一篇已经完整的解析了</span><a href="http://blog.csdn.net/lmj623565791/article/details/38960443" style="box-sizing: border-box; background-color: transparent; margin: 0px; padding: 0px; outline: none; font-family: Arial, 'Microsoft YaHei'; line-height: 0.875rem; color: rgb(66, 139, 202); text-decoration: none;" target="_blank">Android View的事件分发机制</a><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;">，今天给大家代码ViewGroup事件分发的源码解析~~凡是自定义ViewGroup实现各种滑动效果的，不可避免的会出现很多事件的冲突，对ViewGroup事件分发机制的了解，也有益于大家了解冲突产生的原因，以及对冲突进行处理~</span></font></div><h1 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">1、案例</font></span></h1><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">首先我们接着上一篇的代码，在代码中添加一个自定义的LinearLayout：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">package com.example.zhy_event03;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">import android.content.Context;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">import android.util.AttributeSet;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">import android.util.Log;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">import android.view.MotionEvent;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">import android.widget.LinearLayout;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">public class MyLinearLayout extends LinearLayout</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">{</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    private static final String TAG = MyLinearLayout.class.getSimpleName();</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public MyLinearLayout(Context context, AttributeSet attrs)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        super(context, attrs);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    @Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public boolean dispatchTouchEvent(MotionEvent ev)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        int action = ev.getAction();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        switch (action)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_DOWN:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;dispatchTouchEvent ACTION_DOWN&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_MOVE:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;dispatchTouchEvent ACTION_MOVE&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_UP:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;dispatchTouchEvent ACTION_UP&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        default:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        }</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        return super.dispatchTouchEvent(ev);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    @Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public boolean onTouchEvent(MotionEvent event)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        int action = event.getAction();</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        switch (action)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_DOWN:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;onTouchEvent ACTION_DOWN&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_MOVE:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;onTouchEvent ACTION_MOVE&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_UP:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;onTouchEvent ACTION_UP&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        default:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        return super.onTouchEvent(event);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    @Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public boolean onInterceptTouchEvent(MotionEvent ev)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        </font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        int action = ev.getAction();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        switch (action)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_DOWN:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;onInterceptTouchEvent ACTION_DOWN&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_MOVE:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;onInterceptTouchEvent ACTION_MOVE&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_UP:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;onInterceptTouchEvent ACTION_UP&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        default:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        }</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        </font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        return super.onInterceptTouchEvent(ev);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    @Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public void requestDisallowInterceptTouchEvent(boolean disallowIntercept)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        Log.e(TAG, &quot;requestDisallowInterceptTouchEvent &quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        super.requestDisallowInterceptTouchEvent(disallowIntercept);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">继承LinearLayout，然后复写了与事件分发机制有关的代码，添加上了日志的打印~</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">然后看我们的布局文件：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">&lt;com.example.zhy_event03.MyLinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">xmlns:tools=&quot;http://schemas.android.com/tools&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">android:layout_width=&quot;match_parent&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">android:layout_height=&quot;match_parent&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">tools:context=&quot;.MainActivity&quot; &gt;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">&lt;com.example.zhy_event03.MyButton</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">android:id=&quot;@+id/id_btn&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">android:layout_width=&quot;wrap_content&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">android:layout_height=&quot;wrap_content&quot;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">android:text=&quot;click me&quot; /&gt;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">&lt;/com.example.zhy_event03.MyLinearLayout&gt;</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">MyLinearLayout中包含一个MyButton，MyButton都上篇博客中已经出现过，这里就不再贴代码了，不清楚可以去查看~</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">然后MainActivity就是直接加载布局，没有任何代码~~~</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><div><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">直接运行我们的代码，然后点击我们的Button，依然是有意的MOVE一下，不然不会触发MOVE事件，看一下日志的输出：</font></span></div></div><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.287: E/MyLinearLayout(959): dispatchTouchEvent ACTION_DOWN</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.287: E/MyLinearLayout(959): onInterceptTouchEvent ACTION_DOWN</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.287: E/MyButton(959): dispatchTouchEvent ACTION_DOWN</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.297: E/MyButton(959): onTouchEvent ACTION_DOWN</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.297: E/MyButton(959): onTouchEvent ACTION_MOVE</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.327: E/MyLinearLayout(959): dispatchTouchEvent ACTION_MOVE</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.327: E/MyLinearLayout(959): onInterceptTouchEvent ACTION_MOVE</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.337: E/MyButton(959): dispatchTouchEvent ACTION_MOVE</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.337: E/MyButton(959): onTouchEvent ACTION_MOVE</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.457: E/MyLinearLayout(959): dispatchTouchEvent ACTION_UP</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.457: E/MyLinearLayout(959): onInterceptTouchEvent ACTION_UP</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.457: E/MyButton(959): dispatchTouchEvent ACTION_UP</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">09-06 09:57:27.457: E/MyButton(959): onTouchEvent ACTION_UP</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">可以看到大体的事件流程为：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">MyLinearLayout的dispatchTouchEvent -&gt; MyLinearLayout的onInterceptTouchEvent -&gt; MyButton的dispatchTouchEvent -&gt;Mybutton的onTouchEvent </font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">可以看出，在View上触发事件，最先捕获到事件的为View所在的ViewGroup，然后才会到View自身~</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">下面我们按照日志的输出，进入源码~</font></span></div><h1 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">2、源码分析</font></span></h1><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">ViewGroup - dispatchTouchEvent</font></span></div><h2 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">1、ViewGroup - dispatchTouchEvent - ACTION_DOWN</font></span></h2><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">首先是ViewGroup的dispatchTouchEvent方法：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">@Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">public boolean dispatchTouchEvent(MotionEvent ev) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (!onFilterTouchEventForSecurity(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return false;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final int action = ev.getAction();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xf = ev.getX();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yf = ev.getY();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float scrolledXFloat = xf + mScrollX;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float scrolledYFloat = yf + mScrollY;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final Rect frame = mTempRect;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (action == MotionEvent.ACTION_DOWN) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (mMotionTarget != null) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// this is weird, we got a pen down, but we thought it was</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// already down!</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// XXX: We should probably send an ACTION_UP to the current</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// target.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mMotionTarget = null;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// If we're disallowing intercept or if we're allowing and we didn't</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// intercept</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (disallowIntercept || !onInterceptTouchEvent(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// reset this event's action (just to protect ourselves)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setAction(MotionEvent.ACTION_DOWN);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// We know we want to dispatch the event down, find a child</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// who can handle it, start with the front-most child.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final int scrolledXInt = (int) scrolledXFloat;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final int scrolledYInt = (int) scrolledYFloat;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final View[] children = mChildren;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final int count = mChildrenCount;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">for (int i = count - 1; i &gt;= 0; i--) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final View child = children[i];</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if ((child.mViewFlags &amp; VISIBILITY_MASK) == VISIBLE</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">|| child.getAnimation() != null) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">child.getHitRect(frame);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (frame.contains(scrolledXInt, scrolledYInt)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// offset the event to the view's coordinate system</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xc = scrolledXFloat - child.mLeft;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yc = scrolledYFloat - child.mTop;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setLocation(xc, yc);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">child.mPrivateFlags &amp;= ~CANCEL_NEXT_UP_EVENT;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (child.dispatchTouchEvent(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// Event handled, we have a target now.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mMotionTarget = child;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return true;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// The event didn't get handled, try the next view.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// Don't reset the event's location, it's not</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// necessary here.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">} ....//other code omitted</font></span></div></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">代码比较长，决定分段贴出，首先贴出的是ACTION_DOWN事件相关的代码。</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">16行：进入ACTION_DOWN的处理</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">17-23行：将mMotionTarget置为null</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">26行：进行判断：if(disallowIntercept || !onInterceptTouchEvent(ev))</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">两种可能会进入IF代码段</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">1、当前不允许拦截，即disallowIntercept =true，</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">2、当前允许拦截但是不拦截，即disallowIntercept =false,但是onInterceptTouchEvent(ev)返回false ;</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">注：disallowIntercept 可以通过viewGroup.requestDisallowInterceptTouchEvent(boolean);进行设置，后面会详细说；而onInterceptTouchEvent(ev)可以进行复写。</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">36-57行：开始遍历所有的子View</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;">41行：进行判断当前的x,y坐标是否落在子View身上，如果在，47行，执行</span><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">child.dispatchTouchEvent(ev)，就进入了View的<span style="font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; box-sizing: border-box; margin: 0px; padding: 0px;">dispatchTouchEvent代码中了，如果不了解请参考：</span><a href="http://blog.csdn.net/lmj623565791/article/details/38960443" style="box-sizing: border-box; background-color: transparent; margin: 0px; padding: 0px; outline: none; font-family: Arial, 'Microsoft YaHei'; line-height: 18px; color: rgb(66, 139, 202); text-decoration: none;" target="_blank">Android View的事件分发机制</a><span style="font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; box-sizing: border-box; margin: 0px; padding: 0px;">，当</span><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">child</span><span style="font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; box-sizing: border-box; margin: 0px; padding: 0px;">.</span><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">dispatchTouchEvent(ev)返回true，则为mMotionTarget=child;然后return true;</span></span></font></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">ViewGroup的ACTION_DOWN分析结束，总结一下：</font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">ViewGroup实现捕获到DOWN事件，如果代码中不做TOUCH事件拦截，则开始查找当前x,y是否在某个子View的区域内，如果在，则把事件分发下去。</font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">按照日志，接下来到达ACTION_MOVE</font></span></span></div><h2 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; font-weight: 500;"><font style="font-size: 12pt;">2、ViewGroup - dispatchTouchEvent - ACTION_MOVE</font></span></span></h2><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">首先我们源码进行删减，只留下MOVE相关的代码：</font></span></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">@Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">public boolean dispatchTouchEvent(MotionEvent ev) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final int action = ev.getAction();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xf = ev.getX();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yf = ev.getY();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float scrolledXFloat = xf + mScrollX;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float scrolledYFloat = yf + mScrollY;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final Rect frame = mTempRect;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">//...ACTION_DOWN</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">//...ACTIN_UP or ACTION_CANCEL</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// The event wasn't an ACTION_DOWN, dispatch it to our target if</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// we have one.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    final View target = mMotionTarget;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// if have a target, see if we're allowed to and want to intercept its</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// events</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (!disallowIntercept &amp;&amp; onInterceptTouchEvent(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">//....</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// finally offset the event to the target's coordinate system and</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// dispatch the event.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xc = scrolledXFloat - (float) target.mLeft;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yc = scrolledYFloat - (float) target.mTop;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setLocation(xc, yc);</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return target.dispatchTouchEvent(ev);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">18行：把ACTION_DOWN时赋值的mMotionTarget，付给target ; </font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">23行：if (!disallowIntercept &amp;&amp; onInterceptTouchEvent(ev)) 当前允许拦截且拦截了，才进入IF体，当然了默认是不会拦截的~这里执行了<span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">onInterceptTouchEvent(ev)</span></font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">28-30行：把坐标系统转化为子View的坐标系统</font></span></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">32行：直接return <span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">target.dispatchTouchEvent(ev); </span></font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">可以看到，正常流程下，ACTION_MOVE在检测完是否拦截以后，直接调用了子View.<span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">dispatchTouchEvent，事件分发下去；</span></font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">最后就是ACTION_UP了</font></span></span></span></span></div><h2 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; font-weight: 500;"><font style="font-size: 12pt;">3、ViewGroup - dispatchTouchEvent - ACTION_UP</font></span></span></span></span></h2><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">public boolean dispatchTouchEvent(MotionEvent ev) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (!onFilterTouchEventForSecurity(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return false;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final int action = ev.getAction();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xf = ev.getX();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yf = ev.getY();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float scrolledXFloat = xf + mScrollX;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float scrolledYFloat = yf + mScrollY;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final Rect frame = mTempRect;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (action == MotionEvent.ACTION_DOWN) {...}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    </font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    boolean isUpOrCancel = (action == MotionEvent.ACTION_UP) ||</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">(action == MotionEvent.ACTION_CANCEL);</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    if (isUpOrCancel) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mGroupFlags &amp;= ~FLAG_DISALLOW_INTERCEPT;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    final View target = mMotionTarget;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    if(target ==null ){...}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    if (!disallowIntercept &amp;&amp; onInterceptTouchEvent(ev)) {...}</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (isUpOrCancel) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mMotionTarget = null;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// finally offset the event to the target's coordinate system and</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// dispatch the event.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xc = scrolledXFloat - (float) target.mLeft;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yc = scrolledYFloat - (float) target.mTop;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setLocation(xc, yc);</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return target.dispatchTouchEvent(ev);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">17行：判断当前是否是ACTION_UP</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">21，28行：分别重置拦截标志位以及将DOWN赋值的mMotionTarget置为null，都UP了，当然置为null，下一次DOWN还会再赋值的~</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">最后，修改坐标系统，然后调用target.dispatchTouchEvent(ev);</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">正常情况下，即我们上例整个代码的流程我们已经走完了：</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">1、ACTION_DOWN中，ViewGroup捕获到事件，然后判断是否拦截，如果没有拦截，则找到包含当前x,y坐标的子View，赋值给mMotionTarget，然后调用mMotionTarget.dispatchTouchEvent</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">2、ACTION_MOVE中，ViewGroup捕获到事件，然后判断是否拦截，如果没有拦截，则直接调用mMotionTarget.dispatchTouchEvent(ev)</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">3、ACTION_UP中，ViewGroup捕获到事件，然后判断是否拦截，如果没有拦截，则直接调用mMotionTarget.dispatchTouchEvent(ev)</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">当然了在分发之前都会修改下坐标系统，把当前的x，y分别减去child.left 和 child.top ，然后传给child;</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><h1 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">3、关于拦截</font></span></h1><h2 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">1、如何拦截</font></span></h2><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">上面的总结都是基于：如果没有拦截；那么如何拦截呢？</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">复写ViewGroup的onInterceptTouchEvent方法：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">@Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public boolean onInterceptTouchEvent(MotionEvent ev)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        int action = ev.getAction();</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        switch (action)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_DOWN:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            //如果你觉得需要拦截</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            return true ;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_MOVE:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            //如果你觉得需要拦截</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            return true ;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_UP:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            //如果你觉得需要拦截</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            return true ;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        }</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        </font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        return false;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">默认是不拦截的，即返回false；如果你需要拦截，只要return true就行了，这要该事件就不会往子View传递了，并且如果你在DOWN retrun true ，则DOWN,MOVE,UP子View都不会捕获事件；如果你在MOVE return true , 则子View在MOVE和UP都不会捕获事件。</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">原因很简单，当onInterceptTouchEvent(ev) return true的时候，会把mMotionTarget 置为null ; </font></span></div><h2 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">2、如何不被拦截</font></span></h2><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">如果ViewGroup的onInterceptTouchEvent(ev) 当ACTION_MOVE时return true ，即拦截了子View的MOVE以及UP事件；</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">此时子View希望依然能够响应MOVE和UP时该咋办呢？</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">Android给我们提供了一个方法：requestDisallowInterceptTouchEvent(boolean) 用于设置是否允许拦截，我们在子View的dispatchTouchEvent中直接这么写：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">@Override</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    public boolean dispatchTouchEvent(MotionEvent event)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        getParent().requestDisallowInterceptTouchEvent(true);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        int action = event.getAction();</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        switch (action)</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_DOWN:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;dispatchTouchEvent ACTION_DOWN&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_MOVE:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;dispatchTouchEvent ACTION_MOVE&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        case MotionEvent.ACTION_UP:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            Log.e(TAG, &quot;dispatchTouchEvent ACTION_UP&quot;);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        default:</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">            break;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        }</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">        return super.dispatchTouchEvent(event);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">    }</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">getParent().requestDisallowInterceptTouchEvent(true);  这样即使ViewGroup在MOVE的时候return true，子View依然可以捕获到MOVE以及UP事件。</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">从源码也可以解释：</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">ViewGroup MOVE和UP拦截的源码是这样的：</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (!disallowIntercept &amp;&amp; onInterceptTouchEvent(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float xc = scrolledXFloat - (float) target.mLeft;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final float yc = scrolledYFloat - (float) target.mTop;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mPrivateFlags &amp;= ~CANCEL_NEXT_UP_EVENT;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setAction(MotionEvent.ACTION_CANCEL);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setLocation(xc, yc);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (!target.dispatchTouchEvent(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// target didn't handle ACTION_CANCEL. not much we can do</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// but they should have.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// clear the target</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mMotionTarget = null;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// Don't dispatch this event to our own view, because we already</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// saw it when intercepting; we just want to give the following</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// event to the normal onTouchEvent().</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return true;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">当我们把disallowIntercept设置为true时，!disallowIntercept直接为false，于是拦截的方法体就被跳过了~</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">注：如果ViewGroup在onInterceptTouchEvent(ev)  ACTION_DOWN里面直接return true了，那么子View是木有办法的捕获事件的~~~</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><h1 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.1; font-weight: 500;"><font style="font-size: 12pt;">4、如果没有找到合适的子View</font></span></h1><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">我们的实例，直接点击ViewGroup内的按钮，当然直接很顺利的走完整个流程；</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">但是有两种特殊情况</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem; font-weight: bold; box-sizing: border-box;"><font style="font-size: 12pt;">1、ACTION_DOWN的时候，子View.dispatchTouchEvent(ev)返回的为false ; </font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">如果你仔细看了，你会注意到ViewGroup的dispatchTouchEvent(ev)的ACTION_DOWN代码是这样的</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (child.dispatchTouchEvent(ev)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// Event handled, we have a target now.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mMotionTarget = child;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return true;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">只有在child.dispatchTouchEvent(ev)返回true了，才会认为找到了能够处理当前事件的View，即mMotionTarget = child;</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">但是如果返回false,那么mMotionTarget 依然是null</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><div><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">mMotionTarget 为null会咋样呢？</font></span></div></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">其实ViewGroup也是View的子类，如果没有找到能够处理该事件的子View，或者干脆就没有子View；</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 0.875rem;"><font style="font-size: 12pt;">那么，它作为一个View，就相当于View的事件转发了~~直接super.dispatchTouchEvent(ev);</font></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">源码是这样的：</font></span></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">final View target = mMotionTarget;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (target == null) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// We don't have a target, this means we're handling the</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">// event as a regular view.</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setLocation(xf, yf);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if ((mPrivateFlags &amp; CANCEL_NEXT_UP_EVENT) != 0) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">ev.setAction(MotionEvent.ACTION_CANCEL);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">mPrivateFlags &amp;= ~CANCEL_NEXT_UP_EVENT;</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return super.dispatchTouchEvent(ev);</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">}</font></span></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><div><span style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">我们没有一个能够处理该事件的目标元素，意味着我们需要自己处理~~~就相当于传统的View~</font></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; font-weight: bold; box-sizing: border-box;"><font style="font-size: 12pt;">2、那么什么时候子View.dispatchTouchEvent(ev)返回的为true</font></span></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">如果你仔细看了上篇博客，你会发现只要子View支持点击或者长按事件一定返回true~~</font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">源码是这样的：</font></span></span></div><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="white-space: pre-wrap; box-sizing: border-box; display: block; padding: 9.5px; margin: 0px 0px 10px; word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow: hidden; width: 100%;"><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">if (((viewFlags &amp; CLICKABLE) == CLICKABLE ||</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">(viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)) {</font></span></div><div><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; background-color: rgb(245, 245, 245); color: rgb(51, 51, 51); line-height: 1.42857;"><font style="font-size: 12pt;">return true ; }</font></span></div><div><font style="font-size: 12pt;"><br/></font></div></div><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div><h1 style="box-sizing: border-box; margin: 20px 0px 10px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px; font-weight: 500;"><font style="font-size: 12pt;">5、总结</font></span></span></h1><p style="box-sizing: border-box; margin: 0px 0px 10px; font-family: Arial, 'Microsoft YaHei'; padding: 0.2rem 0px 0.3rem; color: rgb(51, 51, 51); line-height: 0.875rem; word-break: break-all;"></p><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">关于代码流程上面已经总结过了~</font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">1、如果ViewGroup找到了能够处理该事件的View，则直接交给子View处理，自己的onTouchEvent不会被触发；</font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Arial, 'Microsoft YaHei'; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">2、可以通过复写onInterceptTouchEvent(ev)方法，拦截子View的事件（即return true），把事件交给自己处理，则会执行自己对应的<span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">onTouchEvent方法</span></font></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">3、子View可以通过调用getParent().requestDisallowInterceptTouchEvent(true);  阻止ViewGroup对其MOVE或者UP事件进行拦截；</font></span></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><div><font style="font-size: 12pt;"><br style="box-sizing:border-box;"/></font></div></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">好了，那么实际应用中能解决哪些问题呢？</font></span></span></span></div><div style="box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;"><font style="font-size: 12pt;">比如你需要写一个类似slidingmenu的左侧隐藏menu，主Activity上有个Button、ListView或者任何可以响应点击的View，你在当前View上死命的滑动，菜单栏也出不来；因为MOVE事件被子View处理了~ 你需要这么做：在ViewGroup的dispatchTouchEvent中判断用户是不是想显示菜单，如果是，则在<span style="box-sizing: border-box; margin: 0px; padding: 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 18px;">onInterceptTouchEvent(ev)拦截子View的事件；自己进行处理，这样自己的onTouchEvent就可以顺利展现出菜单栏了~~</span></font></span></span></span></div><div style="font-size: 0.7rem; box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><br style="box-sizing:border-box;"/></div><div style="font-size: 0.7rem; box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><br style="box-sizing:border-box;"/></div><div style="font-size: 0.6rem;"><br style="box-sizing:border-box;"/></div><div style="font-size: 0.7rem; box-sizing: border-box; margin: 0px 0px 10px; padding: 0.2rem 0px 0.3rem; word-break: break-all;"><br style="box-sizing:border-box;"/></div><div style="font-size: 0.6rem;"></div></div><div style="font-size: 14px;"></div></div></div></div></div></div></div></div><div><br/></div></span>
</div></body></html> 