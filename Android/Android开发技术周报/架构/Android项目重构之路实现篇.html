<html>
<head>
  <title>Android项目重构之路:实现篇</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/10.0.15063 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3436"/>
<h1>Android项目重构之路:实现篇</h1>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="background-color:rgb(255, 255, 255);-webkit-font-smoothing:antialiased;"><div style="color:rgba(0, 0, 0, 0.6);font-family:&quot;Open Sans&quot;, sans-serif;font-size:15px;background-color:rgb(255, 255, 255);line-height:2.1;"><div><div><div style="background-color:rgb(255, 255, 255);">
  <div>
    <h2 style="text-transform:uppercase;letter-spacing:1px;font-size:2.5rem;line-height:1;font-weight:600;color:rgb(95, 95, 95);padding-bottom:10px;"><a style="text-decoration:none;letter-spacing:1px;color:rgb(95, 95, 95);">Android项目重构之路:实现篇</a>



    </h2>
  </div>





  <div style="line-height:1.8em;word-break:break-all;"><p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">原创文章，转载请注明：转载自<a href="http://keeganlee.me/" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">Keegan小钢</a></span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">并标明原文链接：<a href="http://keeganlee.me/post/android/20150629" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;"><strong>http://keeganlee.me/post/android/20150629</strong></a></span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">微信订阅号：<strong>keeganlee_me</strong></span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">写于2015-06-29</span>
</p>


<hr style="border-bottom-color:initial;display:block;border-width:1px 0px 0px;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;height:1px;border-left-color:initial;border-image:initial;border-top-style:solid;border-top-color:rgb(239, 239, 239);margin:3.2em 0px;padding:0px;"/>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><a href="http://keeganlee.me/post/android/20150605" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">Android项目重构之路:架构篇</a></span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><a href="http://keeganlee.me/post/android/20150619" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">Android项目重构之路:界面篇</a></span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><a href="http://keeganlee.me/post/android/20150629" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">Android项目重构之路:实现篇</a></span>
</p>


<hr style="border-bottom-color:initial;display:block;border-width:1px 0px 0px;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;height:1px;border-left-color:initial;border-image:initial;border-top-style:solid;border-top-color:rgb(239, 239, 239);margin:3.2em 0px;padding:0px;"/>

<p style="margin:0.8em 0px;margin-bottom:0.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">前两篇文章<a href="http://keeganlee.me/post/android/20150605" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">Android项目重构之路:架构篇</a>和<a href="http://keeganlee.me/post/android/20150619" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">Android项目重构之路:界面篇</a>已经讲了我的项目开始搭建时的架构设计和界面设计，这篇就讲讲具体怎么实现的，以实现最小化可用产品(MVP)的目标，用最简单的方式来搭建架构和实现代码。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">IDE采用Android Studio，Demo实现的功能为用户注册、登录和展示一个券列表，数据采用我们现有项目的测试数据，接口也是我们项目中的测试接口。</span>
</p>


<blockquote style="box-sizing:border-box;margin:1.6em 0px;padding:0px 0px 0px 1.2em;border-left:0.4em solid rgb(221, 221, 221);color:rgb(85, 85, 85);min-height:20px;">
<h2 style="text-rendering:optimizeLegibility;line-height:1.2em;font-size:1.65em;margin:1em 0px;">项目搭建</h2>
</blockquote>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">根据<a href="http://keeganlee.me/post/android/20150605" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">架构篇</a>所讲的，将项目分为了四个层级：模型层、接口层、核心层、界面层。四个层级之间的关系如下图所示：</span>
</p>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><img src="Android项目重构之路实现篇_files/Image.jpg" type="image/jpeg" data-filename="" alt="" height="278" style="max-width:100%;height:auto;" title="" width="300"/></span>
</p>


<p style="margin:0.8em 0px;margin-bottom:0.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">实现上，在Android Studio分为了相应的四个模块(Module)：<em>model、api、core、app</em>。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">model为模型层，api为接口层，core为核心层，app为界面层。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">model、api、core这三个模块的类型为library，app模块的类型为application。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">四个模块之间的依赖设置为：model没有任何依赖，接口层依赖了模型层，核心层依赖了模型层和接口层，界面层依赖了核心层和模型层。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">项目搭建的步骤如下：</span>
</p>


<ol style="margin:0.8em 0px;">
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">创建新项目，项目名称为KAndroid，包名为com.keegan.kandroid。默认已创建了app模块，查看下app模块下的build.gradle，会看到第一行为：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(85, 85, 85);">apply</span> <span style="color:rgb(85, 85, 85);">plugin:</span> <span style="color:rgb(205, 85, 85);">'com.android.application'</span>
</pre></div>


<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">这行表明了app模块是application类型的。</span>
</p>

</li>
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">分别新建模块model、api、core，Module Type都选为Android Library，在Add an activity to module页面选择Add No Activity，这三个模块做为库使用，并不需要界面。创建完之后，查看相应模块的build.gradle，会看到第一行为：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(85, 85, 85);">apply</span> <span style="color:rgb(85, 85, 85);">plugin:</span> <span style="color:rgb(205, 85, 85);">'com.android.library'</span>
</pre></div>

</li>
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">建立模块之间的依赖关系。有两种方法可以设置：</span>
</p>

</li>
</ol>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">第一种：通过右键模块，然后Open Module Settings，选择模块的Dependencies，点击左下方的加号，选择Module dependency，最后选择要依赖的模块，下图为api模块添加了model依赖；</span>
</p>


<pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><code style="font-family:Inconsolata, monospace, sans-serif;border-radius:2px;word-wrap:break-word;border:none;background:transparent;padding:0px;margin:0px;white-space:pre-wrap;color:rgb(51, 51, 51);font-size:inherit;">![](~/dependencies.jpeg)

第二种：直接在模块的build.gradle设置。打开build.gradle，在最后的dependencies一项里面添加新的一行：compile      project(':ModuleName')，比如app模块添加对model模块和core模块依赖之后的dependencies如下：
```Groovy
dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile 'com.android.support:appcompat-v7:22.0.0'
    compile project(':model')
    compile project(':core')
}
```</code></pre>


<p style="margin:0.8em 0px;margin-bottom:0.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">通过上面两种方式的任意一种，创建了模块之间的依赖关系之后，每个模块的build.gradle的dependencies项的结果将会如下：</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">model:</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    <code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">Groovy</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    dependencies {</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile fileTree(dir: 'libs', include: ['*.jar'])</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile 'com.android.support:appcompat-v7:22.0.0'</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    }    </span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code><br/>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">api:</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    <code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">Groovy</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    dependencies {</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile fileTree(dir: 'libs', include: ['*.jar'])</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile 'com.android.support:appcompat-v7:22.0.0'</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile project(':model')</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    }    </span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code><br/>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">core:</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    <code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">Groovy</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    dependencies {</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile fileTree(dir: 'libs', include: ['*.jar'])</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile 'com.android.support:appcompat-v7:22.0.0'</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile project(':model')</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile project(':api')</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    }    </span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code><br/>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">app:</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    <code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">Groovy</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    dependencies {</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile fileTree(dir: 'libs', include: ['*.jar'])</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile 'com.android.support:appcompat-v7:22.0.0'</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile project(':model')</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">        compile project(':core')</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    }    </span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code>
</p>


<blockquote style="box-sizing:border-box;margin:1.6em 0px;padding:0px 0px 0px 1.2em;border-left:0.4em solid rgb(221, 221, 221);color:rgb(85, 85, 85);min-height:20px;">
<h2 style="text-rendering:optimizeLegibility;line-height:1.2em;font-size:1.65em;margin:1em 0px;">创建业务对象模型</h2>
</blockquote>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">业务对象模型统一存放于model模块，是对业务数据的封装，大部分都是从接口传过来的对象，因此，其属性也与接口传回的对象属性相一致。在这个Demo里，只有一个业务对象模型，封装了券的基本信息，以下是该实体类的代码：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);"> * 券的业务模型类，封装了券的基本信息。</span>
<span style="color:rgb(153, 153, 153);"> * 券分为了三种类型：现金券、抵扣券、折扣券。</span>
<span style="color:rgb(153, 153, 153);"> * 现金券是拥有固定面值的券，有固定的售价；</span>
<span style="color:rgb(153, 153, 153);"> * 抵扣券是满足一定金额后可以抵扣的券，比如满100减10元；</span>
<span style="color:rgb(153, 153, 153);"> * 折扣券是可以打折的券。</span>
<span style="color:rgb(153, 153, 153);"> *</span>
<span style="color:rgb(153, 153, 153);"> * @version 1.0 创建时间：15/6/21</span>
<span style="color:rgb(153, 153, 153);"> */</span>
<span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">CouponBO</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">implements</span> <span style="color:rgb(85, 85, 85);">Serializable</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">long</span> <span style="color:rgb(85, 85, 85);">serialVersionUID</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">-</span><span style="color:rgb(180, 82, 205);">8022957276104379230L</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">id</span><span style="color:rgb(85, 85, 85);">;</span>                <span style="color:rgb(153, 153, 153);">// 券id</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">name</span><span style="color:rgb(85, 85, 85);">;</span>           <span style="color:rgb(153, 153, 153);">// 券名称</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">introduce</span><span style="color:rgb(85, 85, 85);">;</span>      <span style="color:rgb(153, 153, 153);">// 券简介</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">modelType</span><span style="color:rgb(85, 85, 85);">;</span>         <span style="color:rgb(153, 153, 153);">// 券类型，1为现金券，2为抵扣券，3为折扣券</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">double</span> <span style="color:rgb(85, 85, 85);">faceValue</span><span style="color:rgb(85, 85, 85);">;</span>      <span style="color:rgb(153, 153, 153);">// 现金券的面值</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">double</span> <span style="color:rgb(85, 85, 85);">estimateAmount</span><span style="color:rgb(85, 85, 85);">;</span> <span style="color:rgb(153, 153, 153);">// 现金券的售价</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">double</span> <span style="color:rgb(85, 85, 85);">debitAmount</span><span style="color:rgb(85, 85, 85);">;</span>    <span style="color:rgb(153, 153, 153);">// 抵扣券的抵扣金额</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">double</span> <span style="color:rgb(85, 85, 85);">discount</span><span style="color:rgb(85, 85, 85);">;</span>       <span style="color:rgb(153, 153, 153);">// 折扣券的折扣率（0-100）</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">double</span> <span style="color:rgb(85, 85, 85);">miniAmount</span><span style="color:rgb(85, 85, 85);">;</span>     <span style="color:rgb(153, 153, 153);">// 抵扣券和折扣券的最小使用金额</span>

    <span style="color:rgb(153, 153, 153);">// TODO 所有属性的getter和setter</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<blockquote style="box-sizing:border-box;margin:1.6em 0px;padding:0px 0px 0px 1.2em;border-left:0.4em solid rgb(221, 221, 221);color:rgb(85, 85, 85);min-height:20px;">
<h2 style="text-rendering:optimizeLegibility;line-height:1.2em;font-size:1.65em;margin:1em 0px;">接口层的封装</h2>
</blockquote>

<p style="margin:0.8em 0px;margin-bottom:0.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">在这个Demo里，提供了4个接口：一个发送验证码的接口、一个注册接口、一个登录接口、一个获取券列表的接口。这4个接口具体如下：</span>
</p>


<ul style="margin:0.8em 0px;">
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><strong>发送验证码接口</strong></span>
</p>


<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">URL：http://uat.b.quancome.com/platform/api</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">参数：</span>
</p>


<table style="width:100%;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;box-sizing:border-box;margin:1em 0px;line-height:1.7;max-width:100%;border-width:1px;border-style:solid;background-color:transparent;border-spacing:0px;word-break:normal;border-color:rgb(230, 230, 230);">
<thead>
<tr style="border-color:rgb(230, 230, 230);">
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">参数名</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">描述</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">类型</th>
</tr>
</thead>

<tbody>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">appKey</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">ANDROID_KCOUPON</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">method</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">service.sendSmsCode4Register</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;background-color:rgb(249, 249, 249);">phoneNum</td>
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;background-color:rgb(249, 249, 249);">手机号码</td>
<td style="padding:10px 20px;border-color:rgb(230, 230, 230);border-right:0px;border-bottom:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
</tbody>
</table>

<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">输出样例：</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;"><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">json</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;: &quot;success&quot; }</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code>
</p>

</li>
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><strong>注册接口</strong></span>
</p>


<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">URL：http://uat.b.quancome.com/platform/api</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">参数：</span>
</p>


<table style="width:100%;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;box-sizing:border-box;margin:1em 0px;line-height:1.7;max-width:100%;border-width:1px;border-style:solid;background-color:transparent;border-spacing:0px;word-break:normal;border-color:rgb(230, 230, 230);">
<thead>
<tr style="border-color:rgb(230, 230, 230);">
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">参数名</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">描述</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">类型</th>
</tr>
</thead>

<tbody>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">appKey</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">ANDROID_KCOUPON</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">method</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">customer.registerByPhone</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">phoneNum</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">手机号码</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">code</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">验证码</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;background-color:rgb(249, 249, 249);">password</td>
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;background-color:rgb(249, 249, 249);">MD5加密密码</td>
<td style="padding:10px 20px;border-color:rgb(230, 230, 230);border-right:0px;border-bottom:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
</tbody>
</table>

<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">输出样例：</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;"><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">json</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;: &quot;success&quot; }</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code>
</p>

</li>
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><strong>登录接口</strong></span>
</p>


<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">URL：http://uat.b.quancome.com/platform/api</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">其他参数：</span>
</p>


<table style="width:100%;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;box-sizing:border-box;margin:1em 0px;line-height:1.7;max-width:100%;border-width:1px;border-style:solid;background-color:transparent;border-spacing:0px;word-break:normal;border-color:rgb(230, 230, 230);">
<thead>
<tr style="border-color:rgb(230, 230, 230);">
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">参数名</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">描述</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">类型</th>
</tr>
</thead>

<tbody>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">appKey</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">ANDROID_KCOUPON</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">method</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">customer.loginByApp</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">loginName</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">登录名（手机号）</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">password</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">MD5加密密码</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">imei</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">手机imei串号</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;">loginOS</td>
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;">系统，android为1</td>
<td style="padding:10px 20px;border-color:rgb(230, 230, 230);border-right:0px;border-bottom:0px;">int</td>
</tr>
</tbody>
</table>

<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">输出样例：</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;"><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">json</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;: &quot;success&quot; }</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code>
</p>

</li>
<li>
<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><strong>券列表</strong></span>
</p>


<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">URL：http://uat.b.quancome.com/platform/api</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">其他参数：</span>
</p>


<table style="width:100%;font-size:inherit;font-style:inherit;font-variant:inherit;font-weight:inherit;box-sizing:border-box;margin:1em 0px;line-height:1.7;max-width:100%;border-width:1px;border-style:solid;background-color:transparent;border-spacing:0px;word-break:normal;border-color:rgb(230, 230, 230);">
<thead>
<tr style="border-color:rgb(230, 230, 230);">
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">参数名</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">描述</th>
<th style="font-weight:bold;background-color:rgb(253, 253, 253);text-align:left;padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">类型</th>
</tr>
</thead>

<tbody>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">appKey</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">ANDROID_KCOUPON</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">method</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);">issue.listNewCoupon</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;">String</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">currentPage</td>
<td style="padding:10px 20px;border-right:1px solid;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);background-color:rgb(249, 249, 249);">当前页数</td>
<td style="padding:10px 20px;border-bottom:1px solid rgb(230, 230, 230);border-color:rgb(230, 230, 230);border-right:0px;background-color:rgb(249, 249, 249);">int</td>
</tr>
<tr style="border-color:rgb(230, 230, 230);">
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;">pageSize</td>
<td style="padding:10px 20px;border-right:1px solid;border-color:rgb(230, 230, 230);border-bottom:0px;">每页显示数量</td>
<td style="padding:10px 20px;border-color:rgb(230, 230, 230);border-right:0px;border-bottom:0px;">int</td>
</tr>
</tbody>
</table>

<p style="margin:0px;overflow:visible;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">输出样例：</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;"><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">json</code></span><code style="padding:1px 3px;font-family:Inconsolata, monospace, sans-serif;white-space:pre-wrap;border:1px solid rgb(227, 237, 243);background:rgb(247, 247, 249);color:rgb(34, 34, 34);border-radius:2px;word-wrap:break-word;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;: &quot;success&quot;, &quot;maxCount&quot;: 125, &quot;maxPage&quot;: 7, &quot;currentPage&quot;: 1, &quot;pageSize&quot;: 20, &quot;objList&quot;:[</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    {&quot;id&quot;: 1, &quot;name&quot;: &quot;测试现金券&quot;, &quot;modelType&quot;: 1, ...}, </span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    {...}, </span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">    ...</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">]}</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"></span></code>
</p>

</li>
</ul>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">在<a href="http://keeganlee.me/post/android/20150605" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">架构篇</a>已经讲过，接口返回的json数据有三种固定结构：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(85, 85, 85);">{</span><span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;event&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(205, 85, 85);">&quot;0&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;msg&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(205, 85, 85);">&quot;success&quot;</span><span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">{</span><span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;event&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(205, 85, 85);">&quot;0&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;msg&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(205, 85, 85);">&quot;success&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;obj&quot;</span><span style="color:rgb(85, 85, 85);">:{</span><span style="color:rgb(166, 23, 23);background-color:rgb(227, 210, 210);">...</span><span style="color:rgb(85, 85, 85);">}}</span>
<span style="color:rgb(85, 85, 85);">{</span><span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;event&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(205, 85, 85);">&quot;0&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;msg&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(205, 85, 85);">&quot;success&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;objList&quot;</span><span style="color:rgb(85, 85, 85);">:[{</span><span style="color:rgb(166, 23, 23);background-color:rgb(227, 210, 210);">...</span><span style="color:rgb(85, 85, 85);">},</span> <span style="color:rgb(85, 85, 85);">{</span><span style="color:rgb(166, 23, 23);background-color:rgb(227, 210, 210);">...</span><span style="color:rgb(85, 85, 85);">}],</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;currentPage&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;pageSize&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(180, 82, 205);">20</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;maxCount&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(180, 82, 205);">2</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">&quot;maxPage&quot;</span><span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">因此可以封装成实体类，代码如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">event</span><span style="color:rgb(85, 85, 85);">;</span>    <span style="color:rgb(153, 153, 153);">// 返回码，0为成功</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">msg</span><span style="color:rgb(85, 85, 85);">;</span>      <span style="color:rgb(153, 153, 153);">// 返回信息</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">T</span> <span style="color:rgb(85, 85, 85);">obj</span><span style="color:rgb(85, 85, 85);">;</span>           <span style="color:rgb(153, 153, 153);">// 单个对象</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">T</span> <span style="color:rgb(85, 85, 85);">objList</span><span style="color:rgb(85, 85, 85);">;</span>       <span style="color:rgb(153, 153, 153);">// 数组对象</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">;</span> <span style="color:rgb(153, 153, 153);">// 当前页数</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">pageSize</span><span style="color:rgb(85, 85, 85);">;</span>    <span style="color:rgb(153, 153, 153);">// 每页显示数量</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">maxCount</span><span style="color:rgb(85, 85, 85);">;</span>    <span style="color:rgb(153, 153, 153);">// 总条数</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">maxPage</span><span style="color:rgb(85, 85, 85);">;</span>     <span style="color:rgb(153, 153, 153);">// 总页数</span>
    
    <span style="color:rgb(153, 153, 153);">// 构造函数，初始化code和msg</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(0, 139, 69);">ApiResponse</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">event</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">msg</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">event</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">event</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">msg</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">msg</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>
    
    <span style="color:rgb(153, 153, 153);">// 判断结果是否成功</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">boolean</span> <span style="color:rgb(0, 139, 69);">isSuccess</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">event</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">equals</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;0&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>
    
    <span style="color:rgb(153, 153, 153);">// TODO 所有属性的getter和setter</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">上面4个接口，URL和appKey都是一样的，用来区别不同接口的则是method字段，因此，URL和appKey可以统一定义，method则根据不同接口定义不同常量。而除去appKey和method，剩下的参数才是每个接口需要定义的参数。因此，对上面4个接口的定义如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">interface</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">Api</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(153, 153, 153);">// 发送验证码</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">SEND_SMS_CODE</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;service.sendSmsCode4Register&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(153, 153, 153);">// 注册</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">REGISTER</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;customer.registerByPhone&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(153, 153, 153);">// 登录</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">LOGIN</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;customer.loginByApp&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(153, 153, 153);">// 券列表</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">LIST_COUPON</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;issue.listNewCoupon&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    
    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 发送验证码</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param phoneNum 手机号码</span>
<span style="color:rgb(153, 153, 153);">     * @return 成功时返回：{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;:&quot;success&quot; }</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">sendSmsCode4Register</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">);</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 注册</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param phoneNum 手机号码</span>
<span style="color:rgb(153, 153, 153);">     * @param code     验证码</span>
<span style="color:rgb(153, 153, 153);">     * @param password MD5加密的密码</span>
<span style="color:rgb(153, 153, 153);">     * @return 成功时返回：{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;:&quot;success&quot; }</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">registerByPhone</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">);</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 登录</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param loginName 登录名（手机号）</span>
<span style="color:rgb(153, 153, 153);">     * @param password  MD5加密的密码</span>
<span style="color:rgb(153, 153, 153);">     * @param imei      手机IMEI串号</span>
<span style="color:rgb(153, 153, 153);">     * @param loginOS   Android为1</span>
<span style="color:rgb(153, 153, 153);">     * @return 成功时返回：{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;:&quot;success&quot; }</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">loginByApp</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">imei</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">loginOS</span><span style="color:rgb(85, 85, 85);">);</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 券列表</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param currentPage 当前页数</span>
<span style="color:rgb(153, 153, 153);">     * @param pageSize    每页显示数量</span>
<span style="color:rgb(153, 153, 153);">     * @return 成功时返回：{ &quot;event&quot;: &quot;0&quot;, &quot;msg&quot;:&quot;success&quot;, &quot;objList&quot;:[...] }</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;</span> <span style="color:rgb(0, 139, 69);">listNewCoupon</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">pageSize</span><span style="color:rgb(85, 85, 85);">);</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">Api的实现类则是ApiImpl了，实现类需要封装好请求数据并向服务器发起请求，并将响应结果的数据转为ApiResonse返回。而向服务器发送请求并将响应结果返回的处理则封装到http引擎类去处理。另外，这里引用了gson将json转为对象。ApiImpl的实现代码如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">ApiImpl</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">implements</span> <span style="color:rgb(85, 85, 85);">Api</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">APP_KEY</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;ANDROID_KCOUPON&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;CONNECT_TIME_OUT&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT_MSG</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;连接服务器失败&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(153, 153, 153);">// http引擎</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">HttpEngine</span> <span style="color:rgb(85, 85, 85);">httpEngine</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(0, 139, 69);">ApiImpl</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">httpEngine</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">HttpEngine</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getInstance</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">sendSmsCode4Register</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">Map</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">paramMap</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">HashMap</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;();</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;appKey&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">APP_KEY</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;method&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">SEND_SMS_CODE</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;phoneNum&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">);</span>

        <span style="color:rgb(85, 85, 85);">Type</span> <span style="color:rgb(85, 85, 85);">type</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">TypeToken</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;&gt;(){}.</span><span style="color:rgb(101, 139, 0);">getType</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">try</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">httpEngine</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">postHandle</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">type</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">catch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">IOException</span> <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT_MSG</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">registerByPhone</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">Map</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">paramMap</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">HashMap</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;();</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;appKey&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">APP_KEY</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;method&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">REGISTER</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;phoneNum&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;code&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;password&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">EncryptUtil</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">makeMD5</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">));</span>

        <span style="color:rgb(85, 85, 85);">Type</span> <span style="color:rgb(85, 85, 85);">type</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">TypeToken</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;&gt;(){}.</span><span style="color:rgb(101, 139, 0);">getType</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">try</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">httpEngine</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">postHandle</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">type</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">catch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">IOException</span> <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT_MSG</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">loginByApp</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">imei</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">loginOS</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">Map</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">paramMap</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">HashMap</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;();</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;appKey&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">APP_KEY</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;method&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">LOGIN</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;loginName&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;password&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">EncryptUtil</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">makeMD5</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">));</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;imei&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">imei</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;loginOS&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">valueOf</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">loginOS</span><span style="color:rgb(85, 85, 85);">));</span>

        <span style="color:rgb(85, 85, 85);">Type</span> <span style="color:rgb(85, 85, 85);">type</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">TypeToken</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;&gt;(){}.</span><span style="color:rgb(101, 139, 0);">getType</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">try</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">httpEngine</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">postHandle</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">type</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">catch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">IOException</span> <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT_MSG</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;</span> <span style="color:rgb(0, 139, 69);">listNewCoupon</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">pageSize</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">Map</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">paramMap</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">HashMap</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;();</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;appKey&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">APP_KEY</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;method&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">LIST_COUPON</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;currentPage&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">valueOf</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">));</span>
        <span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">put</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;pageSize&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">valueOf</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">pageSize</span><span style="color:rgb(85, 85, 85);">));</span>

        <span style="color:rgb(85, 85, 85);">Type</span> <span style="color:rgb(85, 85, 85);">type</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">TypeToken</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;&gt;(){}.</span><span style="color:rgb(101, 139, 0);">getType</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">try</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">httpEngine</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">postHandle</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">paramMap</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">type</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">catch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">IOException</span> <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">TIME_OUT_EVENT_MSG</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span>
    <span style="color:rgb(85, 85, 85);">}</span>

<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">而http引擎类的实现如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">HttpEngine</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">SERVER_URL</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;http://uat.b.quancome.com/platform/api&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">REQUEST_MOTHOD</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;POST&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">ENCODE_TYPE</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(205, 85, 85);">&quot;UTF-8&quot;</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">TIME_OUT</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(180, 82, 205);">15000</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">HttpEngine</span> <span style="color:rgb(85, 85, 85);">instance</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(0, 139, 69);">HttpEngine</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(85, 85, 85);">HttpEngine</span> <span style="color:rgb(0, 139, 69);">getInstance</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">instance</span> <span style="color:rgb(85, 85, 85);">==</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">instance</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">HttpEngine</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">instance</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">T</span> <span style="color:rgb(0, 139, 69);">postHandle</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Map</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">paramsMap</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Type</span> <span style="color:rgb(85, 85, 85);">typeOfT</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">throws</span> <span style="color:rgb(85, 85, 85);">IOException</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">data</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">joinParams</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">paramsMap</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">HttpUrlConnection</span> <span style="color:rgb(85, 85, 85);">connection</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">getConnection</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRequestProperty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;Content-Length&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">valueOf</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getBytes</span><span style="color:rgb(85, 85, 85);">().</span><span style="color:rgb(101, 139, 0);">length</span><span style="color:rgb(85, 85, 85);">));</span>
        <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">connect</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">OutputStream</span> <span style="color:rgb(85, 85, 85);">os</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getOutputStream</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">os</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">write</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getBytes</span><span style="color:rgb(85, 85, 85);">());</span>
        <span style="color:rgb(85, 85, 85);">os</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">flush</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getResponseCode</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">==</span> <span style="color:rgb(180, 82, 205);">200</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(153, 153, 153);">// 获取响应的输入流对象</span>
            <span style="color:rgb(85, 85, 85);">InputStream</span> <span style="color:rgb(85, 85, 85);">is</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getInputStream</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(153, 153, 153);">// 创建字节输出流对象</span>
            <span style="color:rgb(85, 85, 85);">ByteArrayOutputStream</span> <span style="color:rgb(85, 85, 85);">baos</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ByteArrayOutputStream</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(153, 153, 153);">// 定义读取的长度</span>
            <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">len</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(180, 82, 205);">0</span><span style="color:rgb(85, 85, 85);">;</span>
            <span style="color:rgb(153, 153, 153);">// 定义缓冲区</span>
            <span style="color:rgb(167, 167, 167);font-weight:bold;">byte</span> <span style="color:rgb(85, 85, 85);">buffer</span><span style="color:rgb(85, 85, 85);">[]</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">byte</span><span style="color:rgb(85, 85, 85);">[</span><span style="color:rgb(180, 82, 205);">1024</span><span style="color:rgb(85, 85, 85);">];</span>
            <span style="color:rgb(153, 153, 153);">// 按照缓冲区的大小，循环读取</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">while</span> <span style="color:rgb(85, 85, 85);">((</span><span style="color:rgb(85, 85, 85);">len</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">is</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">read</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">buffer</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(85, 85, 85);">-</span><span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(153, 153, 153);">// 根据读取的长度写入到os对象中</span>
                <span style="color:rgb(85, 85, 85);">baos</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">write</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">buffer</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(180, 82, 205);">0</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">len</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(153, 153, 153);">// 释放资源</span>
            <span style="color:rgb(85, 85, 85);">is</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">close</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(85, 85, 85);">baos</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">close</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">disconnect</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(153, 153, 153);">// 返回字符串</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">result</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">baos</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">toByteArray</span><span style="color:rgb(85, 85, 85);">());</span>
            <span style="color:rgb(85, 85, 85);">Gson</span> <span style="color:rgb(85, 85, 85);">gson</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">Gson</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">gson</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">fromJson</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">result</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">typeOfT</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">disconnect</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
    <span style="color:rgb(85, 85, 85);">}</span>
    
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">HttpURLConnection</span> <span style="color:rgb(0, 139, 69);">getConnection</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">HttpURLConnection</span> <span style="color:rgb(85, 85, 85);">connection</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(153, 153, 153);">// 初始化connection</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">try</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(153, 153, 153);">// 根据地址创建URL对象</span>
            <span style="color:rgb(85, 85, 85);">URL</span> <span style="color:rgb(85, 85, 85);">url</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">URL</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">SERVER_URL</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(153, 153, 153);">// 根据URL对象打开链接</span>
            <span style="color:rgb(85, 85, 85);">connection</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">HttpURLConnection</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">url</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">openConnection</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(153, 153, 153);">// 设置请求的方式</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRequestMethod</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">REQUEST_MOTHOD</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(153, 153, 153);">// 发送POST请求必须设置允许输入，默认为true</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setDoInput</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">true</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(153, 153, 153);">// 发送POST请求必须设置允许输出</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setDoOutput</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">true</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(153, 153, 153);">// 设置不使用缓存</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setUseCaches</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">false</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(153, 153, 153);">// 设置请求的超时时间</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setReadTimeout</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TIME_OUT</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setConnectTimeout</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TIME_OUT</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRequestProperty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;Content-Type&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;application/x-www-form-urlencoded&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRequestProperty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;Connection&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;keep-alive&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRequestProperty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;Response-Type&quot;</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;json&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setChunkedStreamingMode</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(180, 82, 205);">0</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">catch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">IOException</span> <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">printStackTrace</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">connection</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(0, 139, 69);">joinParams</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Map</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">paramsMap</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">StringBuilder</span> <span style="color:rgb(85, 85, 85);">stringBuilder</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">StringBuilder</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">for</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">key</span> <span style="color:rgb(85, 85, 85);">:</span> <span style="color:rgb(85, 85, 85);">paramsMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">keySet</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">stringBuilder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">append</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">key</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">stringBuilder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">append</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;=&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">try</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">stringBuilder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">append</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">URLEncoder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">encode</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">paramsMap</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">get</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">key</span><span style="color:rgb(85, 85, 85);">),</span> <span style="color:rgb(85, 85, 85);">ENCODE_TYPE</span><span style="color:rgb(85, 85, 85);">));</span>
            <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">catch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">UnsupportedEncodingException</span> <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">e</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">printStackTrace</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(85, 85, 85);">stringBuilder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">append</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;&amp;&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">stringBuilder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">substring</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(180, 82, 205);">0</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">stringBuilder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">length</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">-</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:0.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">至此，接口层的封装就完成了。接下来再往上看看核心层吧。</span>
</p>


<blockquote style="box-sizing:border-box;margin:1.6em 0px;padding:0px 0px 0px 1.2em;border-left:0.4em solid rgb(221, 221, 221);color:rgb(85, 85, 85);min-height:20px;">
<h2 style="text-rendering:optimizeLegibility;line-height:1.2em;font-size:1.65em;margin:1em 0px;">核心层的逻辑</h2>
</blockquote>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">核心层处于接口层和界面层之间，向下调用Api，向上提供Action，它的核心任务就是处理复杂的业务逻辑。先看看我对Action的定义：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">interface</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">AppAction</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(153, 153, 153);">// 发送手机验证码</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">sendSmsCode</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(153, 153, 153);">// 注册</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">register</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(153, 153, 153);">// 登录</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">login</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(153, 153, 153);">// 按分页获取券列表</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">listCoupon</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">);</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">首先，和Api接口对比就会发现，参数并不一致。登录并没有iemi和loginOS的参数，获取券列表的参数里也少了pageSize。这是因为，这几个参数，跟界面其实并没有直接关系。Action只要定义好跟界面相关的就可以了，其他需要的参数，在具体实现时再去获取。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">另外，大部分action的处理都是异步的，因此，添加了回调监听器ActionCallbackListener，回调监听器的泛型则是返回的对象数据类型，例如获取券列表，返回的数据类型就是List<span>，没有对象数据时则为Void。回调监听器只定义了成功和失败的方法，如下：</span></span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">interface</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 成功时调用</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param data 返回的数据</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">T</span> <span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">);</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 失败时调用</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param errorEvemt 错误码</span>
<span style="color:rgb(153, 153, 153);">     * @param message    错误信息</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">errorEvent</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">message</span><span style="color:rgb(85, 85, 85);">);</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">接下来再看看Action的实现。首先，要获取imei，那就需要传入一个Context；另外，还需要loginOS和pageSize，这定义为常量就可以了；还有，要调用接口层，所以还需要Api实例。而接口的实现分为两步，第一步做参数检查，第二步用异步任务调用Api。具体实现如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">AppActionImpl</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">implements</span> <span style="color:rgb(85, 85, 85);">AppAction</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">LOGIN_OS</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">;</span> <span style="color:rgb(153, 153, 153);">// 表示Android</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">PAGE_SIZE</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(180, 82, 205);">20</span><span style="color:rgb(85, 85, 85);">;</span> <span style="color:rgb(153, 153, 153);">// 默认每页20条</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">Context</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">Api</span> <span style="color:rgb(85, 85, 85);">api</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(0, 139, 69);">AppActionImpl</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Context</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">context</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">api</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ApiImpl</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">sendSmsCode</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(153, 153, 153);">// 参数为空检查</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextUtils</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_NULL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;手机号为空&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(153, 153, 153);">// 参数合法性检查</span>
        <span style="color:rgb(85, 85, 85);">Pattern</span> <span style="color:rgb(85, 85, 85);">pattern</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">Pattern</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">compile</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;1\\d{10}&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">Matcher</span> <span style="color:rgb(85, 85, 85);">matcher</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">pattern</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">matcher</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(!</span><span style="color:rgb(85, 85, 85);">matcher</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">matches</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_ILLEGAL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;手机号不正确&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>

        <span style="color:rgb(153, 153, 153);">// 请求Api</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">AsyncTask</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;&gt;()</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">doInBackground</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">...</span> <span style="color:rgb(85, 85, 85);">voids</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">api</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">sendSmsCode4Register</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>

            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onPostExecute</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span> <span style="color:rgb(85, 85, 85);">&amp;&amp;</span> <span style="color:rgb(85, 85, 85);">response</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                    <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isSuccess</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">);</span>
                    <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getEvent</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getMsg</span><span style="color:rgb(85, 85, 85);">());</span>
                    <span style="color:rgb(85, 85, 85);">}</span>
                <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">}.</span><span style="color:rgb(101, 139, 0);">execute</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">register</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(153, 153, 153);">// 参数为空检查</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextUtils</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_NULL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;手机号为空&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextUtils</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_NULL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;验证码为空&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextUtils</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_NULL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;密码为空&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        
        <span style="color:rgb(153, 153, 153);">// 参数合法性检查</span>
        <span style="color:rgb(85, 85, 85);">Pattern</span> <span style="color:rgb(85, 85, 85);">pattern</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">Pattern</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">compile</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(205, 85, 85);">&quot;1\\d{10}&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">Matcher</span> <span style="color:rgb(85, 85, 85);">matcher</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">pattern</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">matcher</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(!</span><span style="color:rgb(85, 85, 85);">matcher</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">matches</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_ILLEGAL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;手机号不正确&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        
        <span style="color:rgb(153, 153, 153);">// TODO 长度检查，密码有效性检查等</span>

        <span style="color:rgb(153, 153, 153);">// 请求Api</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">AsyncTask</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;&gt;()</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">doInBackground</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">...</span> <span style="color:rgb(85, 85, 85);">voids</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">api</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">registerByPhone</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">phoneNum</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">code</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>

            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onPostExecute</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span> <span style="color:rgb(85, 85, 85);">&amp;&amp;</span> <span style="color:rgb(85, 85, 85);">response</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                    <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isSuccess</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">);</span>
                    <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getEvent</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getMsg</span><span style="color:rgb(85, 85, 85);">());</span>
                    <span style="color:rgb(85, 85, 85);">}</span>
                <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">}.</span><span style="color:rgb(101, 139, 0);">execute</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">login</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(153, 153, 153);">// 参数为空检查</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextUtils</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_NULL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;登录名为空&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextUtils</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">))</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_NULL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;密码为空&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>

        <span style="color:rgb(153, 153, 153);">// TODO 长度检查，密码有效性检查等        </span>
        
        <span style="color:rgb(153, 153, 153);">// 请求Api</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">AsyncTask</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;&gt;()</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(0, 139, 69);">doInBackground</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">...</span> <span style="color:rgb(85, 85, 85);">voids</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">TelephonyManager</span> <span style="color:rgb(85, 85, 85);">telephonyManager</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TelephonyManager</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getSystemService</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Context</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">TELEPHONY_SERVICE</span><span style="color:rgb(85, 85, 85);">);</span>
                <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">imei</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">telephonyManager</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getDeviceId</span><span style="color:rgb(85, 85, 85);">();</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">api</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">loginByApp</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">imei</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">LOGIN_OS</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>

            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onPostExecute</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span> <span style="color:rgb(85, 85, 85);">&amp;&amp;</span> <span style="color:rgb(85, 85, 85);">response</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                    <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isSuccess</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">);</span>
                    <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getEvent</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getMsg</span><span style="color:rgb(85, 85, 85);">());</span>
                    <span style="color:rgb(85, 85, 85);">}</span>
                <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">}.</span><span style="color:rgb(101, 139, 0);">execute</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">listCoupon</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">final</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;</span> <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(153, 153, 153);">// 参数检查</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">currentPage</span> <span style="color:rgb(85, 85, 85);">&lt;</span> <span style="color:rgb(180, 82, 205);">0</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ErrorEvent</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">PARAM_ILLEGAL</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(205, 85, 85);">&quot;当前页数小于零&quot;</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        
        <span style="color:rgb(153, 153, 153);">// TODO 添加缓存</span>
        
        <span style="color:rgb(153, 153, 153);">// 请求Api</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">AsyncTask</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;&gt;()</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;</span> <span style="color:rgb(0, 139, 69);">doInBackground</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">...</span> <span style="color:rgb(85, 85, 85);">voids</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">api</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">listNewCoupon</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">PAGE_SIZE</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>

            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onPostExecute</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ApiResponse</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listener</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span> <span style="color:rgb(85, 85, 85);">&amp;&amp;</span> <span style="color:rgb(85, 85, 85);">response</span> <span style="color:rgb(85, 85, 85);">!=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                    <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isSuccess</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getObjList</span><span style="color:rgb(85, 85, 85);">());</span>
                    <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span>
                        <span style="color:rgb(85, 85, 85);">listener</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getEvent</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">response</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getMsg</span><span style="color:rgb(85, 85, 85);">());</span>
                    <span style="color:rgb(85, 85, 85);">}</span>
                <span style="color:rgb(85, 85, 85);">}</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">}.</span><span style="color:rgb(101, 139, 0);">execute</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:0.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">简单的实现代码就是这样，其实，这还有很多地方可以优化，比如，将参数为空的检查、手机号有效性的检查、数字型范围的检查等等，都可以抽成独立的方法，从而减少重复代码的编写。异步任务里的代码也一样，都是可以通过重构优化的。另外，需要扩展时，比如添加缓存，那就在调用Api之前处理。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">核心层的逻辑就是这样了。最后就到界面层了。</span>
</p>


<blockquote style="box-sizing:border-box;margin:1.6em 0px;padding:0px 0px 0px 1.2em;border-left:0.4em solid rgb(221, 221, 221);color:rgb(85, 85, 85);min-height:20px;">
<h2 style="text-rendering:optimizeLegibility;line-height:1.2em;font-size:1.65em;margin:1em 0px;">界面层</h2>
</blockquote>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">在这个Demo里，只有三个页面：登录页、注册页、券列表页。在这里，也会遵循<a href="http://keeganlee.me/post/android/20150619" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">界面篇</a>提到的三个基本原则：规范性、单一性、简洁性。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">首先，界面层需要调用核心层的Action，而这会在整个应用级别都用到，因此，Action的实例最好放在Application里。代码如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">KApplication</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">extends</span> <span style="color:rgb(85, 85, 85);">Application</span> <span style="color:rgb(85, 85, 85);">{</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">AppAction</span> <span style="color:rgb(85, 85, 85);">appAction</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onCreate</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">super</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onCreate</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">appAction</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">AppActionImpl</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">AppAction</span> <span style="color:rgb(0, 139, 69);">getAppAction</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">appAction</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">另外，一个Activity的基类也是很有必要的，可以减少很多重复的工作。基类的代码如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">abstract</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">KBaseActivity</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">extends</span> <span style="color:rgb(85, 85, 85);">FragmentActivity</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(153, 153, 153);">// 上下文实例</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">Context</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(153, 153, 153);">// 应用全局的实例</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">KApplication</span> <span style="color:rgb(85, 85, 85);">application</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(153, 153, 153);">// 核心层的Action实例</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">AppAction</span> <span style="color:rgb(85, 85, 85);">appAction</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onCreate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Bundle</span> <span style="color:rgb(85, 85, 85);">savedInstanceState</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">super</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onCreate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">savedInstanceState</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">context</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">getApplicationContext</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">application</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">KApplication</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getApplication</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">appAction</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">application</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getAppAction</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">再看看登录的Activity：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">LoginActivity</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">extends</span> <span style="color:rgb(85, 85, 85);">KBaseActivity</span> <span style="color:rgb(85, 85, 85);">{</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">EditText</span> <span style="color:rgb(85, 85, 85);">phoneEdit</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">EditText</span> <span style="color:rgb(85, 85, 85);">passwordEdit</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">Button</span> <span style="color:rgb(85, 85, 85);">loginBtn</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onCreate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Bundle</span> <span style="color:rgb(85, 85, 85);">savedInstanceState</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">super</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onCreate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">savedInstanceState</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">setContentView</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">layout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">activity_login</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(153, 153, 153);">// 初始化View</span>
        <span style="color:rgb(85, 85, 85);">initViews</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">boolean</span> <span style="color:rgb(0, 139, 69);">onCreateOptionsMenu</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Menu</span> <span style="color:rgb(85, 85, 85);">menu</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">getMenuInflater</span><span style="color:rgb(85, 85, 85);">().</span><span style="color:rgb(101, 139, 0);">inflate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">menu</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">menu_login</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">menu</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">true</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">boolean</span> <span style="color:rgb(0, 139, 69);">onOptionsItemSelected</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">MenuItem</span> <span style="color:rgb(85, 85, 85);">item</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">id</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">item</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getItemId</span><span style="color:rgb(85, 85, 85);">();</span>

        <span style="color:rgb(153, 153, 153);">// 如果是注册按钮</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">id</span> <span style="color:rgb(85, 85, 85);">==</span> <span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">action_register</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">Intent</span> <span style="color:rgb(85, 85, 85);">intent</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">Intent</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">RegisterActivity</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">class</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">startActivity</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">intent</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">true</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>

        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">super</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onOptionsItemSelected</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">item</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(153, 153, 153);">// 初始化View</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">initViews</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">phoneEdit</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">EditText</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">edit_phone</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">passwordEdit</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">EditText</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">edit_password</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">loginBtn</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Button</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">btn_login</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(153, 153, 153);">// 准备登录</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">toLogin</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">View</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">loginName</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">phoneEdit</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getText</span><span style="color:rgb(85, 85, 85);">().</span><span style="color:rgb(101, 139, 0);">toString</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">password</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">passwordEdit</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getText</span><span style="color:rgb(85, 85, 85);">().</span><span style="color:rgb(101, 139, 0);">toString</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">loginBtn</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setEnabled</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">false</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">appAction</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">login</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">loginName</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">password</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Void</span><span style="color:rgb(85, 85, 85);">&gt;()</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Void</span> <span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">Toast</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">makeText</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">string</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">toast_login_success</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Toast</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">LENGTH_SHORT</span><span style="color:rgb(85, 85, 85);">).</span><span style="color:rgb(101, 139, 0);">show</span><span style="color:rgb(85, 85, 85);">();</span>
                <span style="color:rgb(85, 85, 85);">Intent</span> <span style="color:rgb(85, 85, 85);">intent</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">Intent</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">CouponListActivity</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">class</span><span style="color:rgb(85, 85, 85);">);</span>
                <span style="color:rgb(85, 85, 85);">startActivity</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">intent</span><span style="color:rgb(85, 85, 85);">);</span>
                <span style="color:rgb(85, 85, 85);">finish</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(85, 85, 85);">}</span>

            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">errorEvent</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">message</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">Toast</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">makeText</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">message</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Toast</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">LENGTH_SHORT</span><span style="color:rgb(85, 85, 85);">).</span><span style="color:rgb(101, 139, 0);">show</span><span style="color:rgb(85, 85, 85);">();</span>
                <span style="color:rgb(85, 85, 85);">loginBtn</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setEnabled</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">true</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">});</span>
    <span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">登录页的布局文件则如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">LinearLayout</span> <span style="color:rgb(85, 85, 85);">xmlns</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span style="color:rgb(85, 85, 85);">xmlns</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">tools</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;http://schemas.android.com/tools&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_width</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;match_parent&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_height</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;match_parent&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">orientation</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;vertical&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">paddingBottom</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/activity_vertical_margin&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">paddingLeft</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/activity_horizontal_margin&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">paddingRight</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/activity_horizontal_margin&quot;</span>
    <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">paddingTop</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/activity_vertical_margin&quot;</span>
    <span style="color:rgb(85, 85, 85);">tools</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;com.keegan.kandroid.activity.LoginActivity&quot;</span><span style="color:rgb(85, 85, 85);">&gt;</span>

    <span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">EditText</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">id</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@+id/edit_phone&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_width</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;match_parent&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_height</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;wrap_content&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_marginTop</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/edit_vertical_margin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_marginBottom</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/edit_vertical_margin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">hint</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@string/hint_phone&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">inputType</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;phone&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">singleLine</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;true&quot;</span> <span style="color:rgb(85, 85, 85);">/&gt;</span>

    <span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">EditText</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">id</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@+id/edit_password&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_width</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;match_parent&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_height</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;wrap_content&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_marginTop</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/edit_vertical_margin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_marginBottom</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/edit_vertical_margin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">hint</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@string/hint_password&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">inputType</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;textPassword&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">singleLine</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;true&quot;</span> <span style="color:rgb(85, 85, 85);">/&gt;</span>

    <span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">Button</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">id</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@+id/btn_login&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_width</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;match_parent&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_height</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;wrap_content&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_marginTop</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/btn_vertical_margin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">layout_marginBottom</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@dimen/btn_vertical_margin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">onClick</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;toLogin&quot;</span>
        <span style="color:rgb(85, 85, 85);">android</span><span style="color:rgb(85, 85, 85);">:</span><span style="color:rgb(85, 85, 85);">text</span><span style="color:rgb(85, 85, 85);">=</span><span style="color:rgb(205, 85, 85);">&quot;@string/btn_login&quot;</span> <span style="color:rgb(85, 85, 85);">/&gt;</span>

<span style="color:rgb(85, 85, 85);">&lt;/</span><span style="color:rgb(85, 85, 85);">LinearLayout</span><span style="color:rgb(85, 85, 85);">&gt;</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">可以看到，EditText的id命名统一以edit开头，而在Activity里的控件变量名则以Edit结尾。按钮的onClick也统一用toXXX的方式命名，明确表明这是一个将要做的动作。还有，string，dimen也都统一在相应的资源文件里按照相应的规范去定义。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">注册页和登陆页差不多，这里就不展示代码了。主要再看看券列表页，因为用到了ListView，ListView需要添加适配器。实际上，适配器很多代码都是可以复用的，因此，我抽象了一个适配器的基类，代码如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">abstract</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">KBaseAdapter</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">extends</span> <span style="color:rgb(85, 85, 85);">BaseAdapter</span> <span style="color:rgb(85, 85, 85);">{</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">Context</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">LayoutInflater</span> <span style="color:rgb(85, 85, 85);">inflater</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">itemList</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ArrayList</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;();</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(0, 139, 69);">KBaseAdapter</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Context</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">context</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">inflater</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">LayoutInflater</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">from</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 判断数据是否为空</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @return 为空返回true，不为空返回false</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">boolean</span> <span style="color:rgb(0, 139, 69);">isEmpty</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 在原有的数据上添加新数据</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param itemList</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">addItems</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">addAll</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">notifyDataSetChanged</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 设置为新的数据，旧数据会被清空</span>
<span style="color:rgb(153, 153, 153);">     *</span>
<span style="color:rgb(153, 153, 153);">     * @param itemList</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">setItems</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">T</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">clear</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">itemList</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">notifyDataSetChanged</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(153, 153, 153);">/**</span>
<span style="color:rgb(153, 153, 153);">     * 清空数据</span>
<span style="color:rgb(153, 153, 153);">     */</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">clearItems</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">clear</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">notifyDataSetChanged</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(0, 139, 69);">getCount</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">size</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">Object</span> <span style="color:rgb(0, 139, 69);">getItem</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">get</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">long</span> <span style="color:rgb(0, 139, 69);">getItemId</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">abstract</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">View</span> <span style="color:rgb(0, 139, 69);">getView</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">View</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ViewGroup</span> <span style="color:rgb(85, 85, 85);">viewGroup</span><span style="color:rgb(85, 85, 85);">);</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">这个抽象基类集成了设置数据的方法，每个具体的适配器类只要再实现各自的getView方法就可以了。本Demo的券列表的适配器如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">CouponListAdapter</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">extends</span> <span style="color:rgb(85, 85, 85);">KBaseAdapter</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">{</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(0, 139, 69);">CouponListAdapter</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Context</span> <span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">super</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(85, 85, 85);">View</span> <span style="color:rgb(0, 139, 69);">getView</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">View</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">ViewGroup</span> <span style="color:rgb(85, 85, 85);">viewGroup</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">ViewHolder</span> <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">view</span> <span style="color:rgb(85, 85, 85);">==</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">null</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">view</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">inflater</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">inflate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">layout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">item_list_coupon</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">viewGroup</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">false</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">holder</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ViewHolder</span><span style="color:rgb(85, 85, 85);">();</span>
            <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">titleText</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextView</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">text_item_title</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">infoText</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextView</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">text_item_info</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">priceText</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">TextView</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">text_item_price</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setTag</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(85, 85, 85);">holder</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ViewHolder</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getTag</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">}</span>

        <span style="color:rgb(85, 85, 85);">CouponBO</span> <span style="color:rgb(85, 85, 85);">coupon</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">itemList</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">get</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">i</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">titleText</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setText</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getName</span><span style="color:rgb(85, 85, 85);">());</span>
        <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">infoText</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setText</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getIntroduce</span><span style="color:rgb(85, 85, 85);">());</span>
        <span style="color:rgb(85, 85, 85);">SpannableString</span> <span style="color:rgb(85, 85, 85);">priceString</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(153, 153, 153);">// 根据不同的券类型展示不同的价格显示方式</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">switch</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getModelType</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">default</span><span style="color:rgb(85, 85, 85);">:</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">case</span> <span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">TYPE_CASH</span><span style="color:rgb(85, 85, 85);">:</span>
                <span style="color:rgb(85, 85, 85);">priceString</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">CouponPriceUtil</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getCashPrice</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getFaceValue</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getEstimateAmount</span><span style="color:rgb(85, 85, 85);">());</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">break</span><span style="color:rgb(85, 85, 85);">;</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">case</span> <span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">TYPE_DEBIT</span><span style="color:rgb(85, 85, 85);">:</span>
                <span style="color:rgb(85, 85, 85);">priceString</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">CouponPriceUtil</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getVoucherPrice</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getDebitAmount</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getMiniAmount</span><span style="color:rgb(85, 85, 85);">());</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">break</span><span style="color:rgb(85, 85, 85);">;</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">case</span> <span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">TYPE_DISCOUNT</span><span style="color:rgb(85, 85, 85);">:</span>
                <span style="color:rgb(85, 85, 85);">priceString</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">CouponPriceUtil</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getDiscountPrice</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getDiscount</span><span style="color:rgb(85, 85, 85);">(),</span> <span style="color:rgb(85, 85, 85);">coupon</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">getMiniAmount</span><span style="color:rgb(85, 85, 85);">());</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">break</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">holder</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">priceText</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setText</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">priceString</span><span style="color:rgb(85, 85, 85);">);</span>

        <span style="color:rgb(139, 0, 139);font-weight:bold;">return</span> <span style="color:rgb(85, 85, 85);">view</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">static</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">ViewHolder</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">TextView</span> <span style="color:rgb(85, 85, 85);">titleText</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">TextView</span> <span style="color:rgb(85, 85, 85);">infoText</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">TextView</span> <span style="color:rgb(85, 85, 85);">priceText</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(85, 85, 85);">}</span>

<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">而券列表的Activity简单实现如下：</span>
</p>

<div style="background:rgb(238, 238, 221);"><pre style="font-family:Inconsolata, monospace, sans-serif;box-sizing:border-box;border:1px solid rgb(227, 237, 243);width:100%;padding:10px;margin:1.6em 0px;font-size:0.9em;white-space:pre;overflow:auto;background:rgb(247, 250, 251);border-radius:3px;"><span></span><span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">class</span> <span style="color:rgb(0, 139, 69);font-weight:bold;">CouponListActivity</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">extends</span> <span style="color:rgb(85, 85, 85);">KBaseActivity</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">implements</span> <span style="color:rgb(85, 85, 85);">SwipeRefreshLayout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">OnRefreshListener</span> <span style="color:rgb(85, 85, 85);">{</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">SwipeRefreshLayout</span> <span style="color:rgb(85, 85, 85);">swipeRefreshLayout</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">ListView</span> <span style="color:rgb(85, 85, 85);">listView</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(85, 85, 85);">CouponListAdapter</span> <span style="color:rgb(85, 85, 85);">listAdapter</span><span style="color:rgb(85, 85, 85);">;</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">int</span> <span style="color:rgb(85, 85, 85);">currentPage</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">;</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">protected</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onCreate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">Bundle</span> <span style="color:rgb(85, 85, 85);">savedInstanceState</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">super</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">onCreate</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">savedInstanceState</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">setContentView</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">layout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">activity_coupon_list</span><span style="color:rgb(85, 85, 85);">);</span>

        <span style="color:rgb(85, 85, 85);">initViews</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">getData</span><span style="color:rgb(85, 85, 85);">();</span>

        <span style="color:rgb(153, 153, 153);">// TODO 添加上拉加载更多的功能</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">initViews</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(85, 85, 85);">swipeRefreshLayout</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">SwipeRefreshLayout</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">swipe_refresh_layout</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">swipeRefreshLayout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setOnRefreshListener</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">listView</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">ListView</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">findViewById</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">R</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">id</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">list_view</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">listAdapter</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">CouponListAdapter</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">);</span>
        <span style="color:rgb(85, 85, 85);">listView</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setAdapter</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">listAdapter</span><span style="color:rgb(85, 85, 85);">);</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(139, 0, 139);font-weight:bold;">private</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">getData</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(139, 0, 139);font-weight:bold;">this</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">appAction</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">listCoupon</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">currentPage</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">new</span> <span style="color:rgb(85, 85, 85);">ActionCallbackListener</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;&gt;()</span> <span style="color:rgb(85, 85, 85);">{</span>
            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onSuccess</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">List</span><span style="color:rgb(85, 85, 85);">&lt;</span><span style="color:rgb(85, 85, 85);">CouponBO</span><span style="color:rgb(85, 85, 85);">&gt;</span> <span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(!</span><span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">isEmpty</span><span style="color:rgb(85, 85, 85);">())</span> <span style="color:rgb(85, 85, 85);">{</span>
                    <span style="color:rgb(139, 0, 139);font-weight:bold;">if</span> <span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">currentPage</span> <span style="color:rgb(85, 85, 85);">==</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span> <span style="color:rgb(153, 153, 153);">// 第一页</span>
                        <span style="color:rgb(85, 85, 85);">listAdapter</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setItems</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">);</span>
                    <span style="color:rgb(85, 85, 85);">}</span> <span style="color:rgb(139, 0, 139);font-weight:bold;">else</span> <span style="color:rgb(85, 85, 85);">{</span> <span style="color:rgb(153, 153, 153);">// 分页数据</span>
                        <span style="color:rgb(85, 85, 85);">listAdapter</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">addItems</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">data</span><span style="color:rgb(85, 85, 85);">);</span>
                    <span style="color:rgb(85, 85, 85);">}</span>
                <span style="color:rgb(85, 85, 85);">}</span>
                <span style="color:rgb(85, 85, 85);">swipeRefreshLayout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRefreshing</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">false</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>

            <span style="color:rgb(112, 122, 124);">@Override</span>
            <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onFailure</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">errorEvent</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">String</span> <span style="color:rgb(85, 85, 85);">message</span><span style="color:rgb(85, 85, 85);">)</span> <span style="color:rgb(85, 85, 85);">{</span>
                <span style="color:rgb(85, 85, 85);">Toast</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">makeText</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(85, 85, 85);">context</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">message</span><span style="color:rgb(85, 85, 85);">,</span> <span style="color:rgb(85, 85, 85);">Toast</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">LENGTH_SHORT</span><span style="color:rgb(85, 85, 85);">).</span><span style="color:rgb(101, 139, 0);">show</span><span style="color:rgb(85, 85, 85);">();</span>
                <span style="color:rgb(85, 85, 85);">swipeRefreshLayout</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">setRefreshing</span><span style="color:rgb(85, 85, 85);">(</span><span style="color:rgb(139, 0, 139);font-weight:bold;">false</span><span style="color:rgb(85, 85, 85);">);</span>
            <span style="color:rgb(85, 85, 85);">}</span>
        <span style="color:rgb(85, 85, 85);">});</span>
    <span style="color:rgb(85, 85, 85);">}</span>

    <span style="color:rgb(112, 122, 124);">@Override</span>
    <span style="color:rgb(139, 0, 139);font-weight:bold;">public</span> <span style="color:rgb(167, 167, 167);font-weight:bold;">void</span> <span style="color:rgb(0, 139, 69);">onRefresh</span><span style="color:rgb(85, 85, 85);">()</span> <span style="color:rgb(85, 85, 85);">{</span>
        <span style="color:rgb(153, 153, 153);">// 需要重置当前页为第一页，并且清掉数据</span>
        <span style="color:rgb(85, 85, 85);">currentPage</span> <span style="color:rgb(85, 85, 85);">=</span> <span style="color:rgb(180, 82, 205);">1</span><span style="color:rgb(85, 85, 85);">;</span>
        <span style="color:rgb(85, 85, 85);">listAdapter</span><span style="color:rgb(85, 85, 85);">.</span><span style="color:rgb(101, 139, 0);">clearItems</span><span style="color:rgb(85, 85, 85);">();</span>
        <span style="color:rgb(85, 85, 85);">getData</span><span style="color:rgb(85, 85, 85);">();</span>
    <span style="color:rgb(85, 85, 85);">}</span>
<span style="color:rgb(85, 85, 85);">}</span>
</pre></div>


<blockquote style="box-sizing:border-box;margin:1.6em 0px;padding:0px 0px 0px 1.2em;border-left:0.4em solid rgb(221, 221, 221);color:rgb(85, 85, 85);min-height:20px;">
<h2 style="text-rendering:optimizeLegibility;line-height:1.2em;font-size:1.65em;margin:1em 0px;">完结</h2>
</blockquote>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">终于写完了，代码也终于放上了github，为了让人更容易理解，因此很多都比较简单，没有再进行扩展。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">github地址：<a href="https://github.com/keeganlee/kandroid" style="opacity:1;transition:all 0.15s linear;color:rgb(60, 189, 16);text-decoration:none;letter-spacing:1px;">https://github.com/keeganlee/kandroid</a></span>
</p>


<hr style="border-bottom-color:initial;display:block;border-width:1px 0px 0px;border-right-style:initial;border-bottom-style:initial;border-left-style:initial;border-right-color:initial;height:1px;border-left-color:initial;border-image:initial;border-top-style:solid;border-top-color:rgb(239, 239, 239);margin:3.2em 0px;padding:0px;"/>

<p style="margin:0.8em 0px;margin-bottom:2.2em;">
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;">扫描以下二维码即可关注订阅号。</span>
    <span style="margin-top:0px;margin-bottom:0.6em;display:block;line-height:1.75;text-indent:0px;"><img src="Android项目重构之路实现篇_files/Image [1].jpg" type="image/jpeg" data-filename="" alt="" height="430" style="max-width:100%;height:auto;" title="" width="430"/></span>
</p></div>

  <div style="padding:0px 0px 60px;border-bottom:1px solid rgb(242, 242, 242);">
    <div style="padding-bottom:15px;font-size:13px;"><a href="http://keeganlee.me/tags/Android" style="border:1px solid rgba(0, 0, 0, 0.15);display:inline-block;outline:0px;border-radius:999em;background:transparent;font-style:normal;text-align:center;white-space:nowrap;cursor:pointer;position:relative;opacity:1;transition:all 0.15s linear;text-decoration:none;font-weight:400;font-size:12px;color:rgba(0, 0, 0, 0.44);margin:0px 5px;padding:6px 12px;">Android</a>

<a href="http://keeganlee.me/tags/%E6%9E%B6%E6%9E%84" style="border:1px solid rgba(0, 0, 0, 0.15);display:inline-block;outline:0px;border-radius:999em;background:transparent;font-style:normal;text-align:center;white-space:nowrap;cursor:pointer;position:relative;opacity:1;transition:all 0.15s linear;text-decoration:none;font-weight:400;font-size:12px;color:rgba(0, 0, 0, 0.44);margin:0px 5px;padding:6px 12px;">架构</a>


    </div>


    <div style="max-width:100%;height:25px;color:rgb(187, 187, 187);font-size:12px;margin-top:10px;"><i style="font-stretch:normal;-webkit-font-smoothing:antialiased;font-style:normal;font-variant:normal;font-weight:normal;display:inline-block;line-height:1;font-family:FontAwesome;font-size:inherit;text-rendering:auto;margin-right:3px;"><span style="font-style:normal;font-variant:normal;font-weight:normal;line-height:1;font-family:FontAwesome;font-size:inherit;"></span></i>
<span style="margin-right:15px;">2015-06-29</span>
<i style="font-stretch:normal;-webkit-font-smoothing:antialiased;font-style:normal;font-variant:normal;font-weight:normal;display:inline-block;line-height:1;font-family:FontAwesome;font-size:inherit;text-rendering:auto;margin-right:3px;"><span style="font-style:normal;font-variant:normal;font-weight:normal;line-height:1;font-family:FontAwesome;font-size:inherit;"></span></i>
<a href="http://keeganlee.me/post/android/20150629#comments" style="opacity:1;transition:all 0.15s linear;text-decoration:none;color:rgb(187, 187, 187);">0 Comments</a>

    </div>

  </div>

</div></div></div></div></div></div><br/></div></span>
</div></body></html> 